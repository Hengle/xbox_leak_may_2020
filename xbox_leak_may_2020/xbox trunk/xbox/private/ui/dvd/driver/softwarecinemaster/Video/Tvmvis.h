////////////////////////////////////////////////////////////////////////////////
//                                                                            //
// Copyright 2000-2001 STMicroelectronics, Inc.  All Rights Reserved.         //
// HIGHLY CONFIDENTIAL INFORMATION:  This source code contains                //
// confidential and proprietary information of STMicroelectronics, Inc.       //
// This source code is provided to Microsoft Corporation under a written      //
// confidentiality agreement between STMicroelectronics and Microsoft.  This  //
// software may not be reproduced, distributed, modified, disclosed, used,    //
// displayed, stored in a retrieval system or transmitted in whole or in part,//
// in any form or by any means, electronic, mechanical, photocopying or       //
// otherwise, except as expressly authorized by STMicroelectronics. THE ONLY  //
// PERSONS WHO MAY HAVE ACCESS TO THIS SOFTWARE ARE THOSE PERSONS             //
// AUTHORIZED BY RAVISENT, WHO HAVE EXECUTED AND DELIVERED A                  //
// WRITTEN CONFIDENTIALITY AGREEMENT TO STMicroelectronics, IN THE FORM       //
// PRESCRIBED BY STMicroelectronics.                                          //
//                                                                            //
////////////////////////////////////////////////////////////////////////////////

#ifndef _TVmvis_HPP_
#define _TVmvis_HPP_

#ifdef INITGUIDS
#include <initguid.h>
#endif

//Use Guidgen.exe to generate new unique GUIDs.
//{F1506F63-896F-11d0-9445-008029E64916}
DEFINE_GUID(IID_ITVOutMacrovision, 0xF1506F63, 0x896F, 0x11d0, 0x94, 0x45, 0x00, 0x80, 0x29, 0xE6, 0x49, 0x16);

#undef INTERFACE
#define INTERFACE ITVOutMacrovision

DECLARE_INTERFACE_(ITVOutMacrovision, IUnknown)
{
 	//IUnknown members;
 	STDMETHOD(QueryInterface) (THIS_ REFIID, LPVOID*) PURE;
 	STDMETHOD_(ULONG, AddRef) (THIS) PURE;
 	STDMETHOD_(ULONG, Release) (THIS) PURE;


	// Returns TRUE in <lpbIsTrue> if any macrovision mode is
	// currently enabled.
	STDMETHOD( IsMacrovisionOn )	(THIS_ WORD wCard, LPBOOL lpbIsTrue) PURE;

	// Used to start a macrovision session. The macrovision mode is
	// equvalent to the macrovision mode bits in the DVD stream.
	// <lpdwKey> is generated by the driver and used to authenticate
	// all future transactions.
	STDMETHOD( SetMacrovisionOn )	(THIS_ WORD wCard, DWORD dwMode, LPDWORD lpdwKey) PURE;

	// Used to modify the mode of an active macrovision session.
	// The macrovision mode is equvalent to the macrovision mode bits in
	// the DVD stream. <lpdwKey> must be the same one that was returned
	// as part of an earlier <SetMacrovisionOn> call
	STDMETHOD( ResetMacrovision )	(THIS_ WORD wCard, DWORD dwMode, DWORD dwKey) PURE;

	// Used to end a macrovision session. <lpdwKey> must be the same one
	// that was returned as part of an earlier <SetMacrovisionOn> call.
	// After this call <lpdwKey> is no longer valid.
	STDMETHOD( SetMacrovisionOff )	(THIS_ WORD wCard, DWORD dwKey) PURE;

 	//ITVOutMacrovision members
};  typedef ITVOutMacrovision *LPITVOutMacrovision;

#endif //_TVmvis_HPP_
