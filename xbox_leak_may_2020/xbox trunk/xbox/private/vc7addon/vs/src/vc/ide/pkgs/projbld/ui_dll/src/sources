!IF 0

Copyright (c) 1990-1998  Microsoft Corporation

Module Name:

    sources.

Abstract:

    This file specifies the target component being built and the list of
    sources files needed to build that component.  Also specifies optional
    compiler switches and libraries that are unique for the component being
    built.

!ENDIF
!include $(_NTROOT)\private\vc7addon\vsenv.inc

!include ..\..\..\..\sources.inc

TARGETNAME=VCProject
TARGETTYPE=DYNLINK
# TARGETPATH=$(VSBUILT)\$(BUILT_FLAVOR)\bin\$(TARGET_DIRECTORY)\$(VC7)\$(VCPACKAGES)
# TARGETPATHLIB=$(VSBUILT)\$(BUILT_FLAVOR)\lib\$(TARGET_DIRECTORY)
# Remember to edit placefile.lst
TARGETPATH=$(O)
TARGETPATHLIB=$(O)

TARGETEXT=dll

NO_BBT_COMMANDS=1
UMTYPE=windows

USE_IOSTREAM=1
USE_STATIC_ATL=1
USE_VSANSIDELAYLOAD=1

COFFBASE=VCProject
DLLDEF=projbld.def
DLLENTRY=_DllMainCRTStartup

# this allows the use of a localized version of the resource file
!if "$(RCFILE)" == ""
RCFILE=projbld
!endif
NO_EH=0


USER_INCLUDES=$(VC_INCLUDES);$(EXTERNAL_ROOT)\inc;$(VSBUILT)\$(BUILT_FLAVOR)\bin\$(TARGET_DIRECTORY);$(VSROOT)\src\common\idl\vs;$(VSROOT)\src\common\win95
LAST_INCLUDES=$(LANGAPI_ROOT)\include;$(LANGAPI_ROOT)\ncb;$(VCROOT)\pkgs\projbld\vcpb

USER_C_DEFINES=$(USER_C_DEFINES) -DVC_PROXY -DNEW_PROJ_VIEW -DSTRICT -D_VRES -DVS_PACKAGE -DUNICODE
#USER_C_DEFINES=$(USER_C_DEFINES) -DVC_PROXY -DNEW_PROJ_VIEW -DSTRICT -D_VRES -DVS_PACKAGE
USER_C_FLAGS=$(USER_C_FLAGS) -EHsc

LIBRARIAN_FLAGS=$(LIBRARIAN_FLAGS) -name:$(TARGETNAME)
LINK_LIB_IGNORE_FLAG=$(LINK_LIB_IGNORE_FLAG) -IGNORE:4075,4099

DELAYLOAD=shell32.dll;comdlg32.dll;vsansi.dll

# These files are listed in alphabetical order.  Keep them that way!
SOURCES= \
	AutoFile.cpp \
	AutoFilter.cpp \
	AutoProject.cpp \
	bldpkg.cpp \
	bldtst.cpp \
	DataObject.cpp \
	directoriesdlg.cpp \
	ErrContext.cpp \
	filegencfg.cpp \
	gencfg.cpp \
	guids.cpp \
	exehierarchy.cpp \
	localeinfo.cpp \
	optionsdlg.cpp \
	outgroup.cpp \
	output.cpp \
	outsenum.cpp \
	prjnode.cpp \
	projbld.cpp \
	projbuildevents.cpp \
	projouts.cpp \
	utils.cpp \
	vcarchy.cpp \
	vcbsnode.cpp \
	vcfgrp.cpp \
	vcfile.cpp \
	vcnode.cpp \
	VCPropObject.cpp \
	$(RCFILE).rc

TARGETLIBS= \
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\vcutillib$(D).lib \
	$(VSBUILT)\$(BUILT_FLAVOR)\lib\*\vcidl.lib \
	$(VSBUILT)\$(BUILT_FLAVOR)\lib\*\vsguids.lib \
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\vseeguids.lib \
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\envguids.lib \
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\ad2ide.lib \
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\util$(D).lib \
	$(VSBUILT)\$(BUILT_FLAVOR)\lib\*\deployguids.lib \
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\unilib$(D).lib \
!if "$(BUILD_RETAIL)"=="no"
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\vsassert.lib \
!endif
!IF "$(BUILD_TARGET_ARCHITECTURE)"=="x86" # This line MUST come after all of the VS libraries, but before the SDK libraries.
	$(VSPREBUILT)\$(BUILT_FLAVOR)\lib\*\vsansidelayimp.lib \
!ENDIF
	$(SDK_LIB_PATH)\uuid.lib \
	$(SDK_LIB_PATH)\oleaut32.lib \
	$(SDK_LIB_PATH)\ole32.lib \
	$(SDK_LIB_PATH)\kernel32.lib \
	$(SDK_LIB_PATH)\gdi32.lib \
	$(SDK_LIB_PATH)\user32.lib \
	$(SDK_LIB_PATH)\shell32.lib \
	$(SDK_LIB_PATH)\comdlg32.lib \
	$(SDK_LIB_PATH)\comctl32.lib \
	$(SDK_LIB_PATH)\version.lib \
	$(SDK_LIB_PATH)\advapi32.lib \
	$(SDK_LIB_PATH)\shlwapi.lib \
	$(SDK_LIB_PATH)\wininet.lib

PRECOMPILED_INCLUDE=stdafx.h
PRECOMPILED_SOURCEFILE=stdafx.cpp
PRECOMPILED_PCH=stdafx.pch
PRECOMPILED_OBJ=stdafx.obj
PRECOMPILED_CXX=1

#POSTBUILD_CMD = preg projbld $(BINPLACE_PLACEFILE) $(_NTTREE) regsvr32 -s !TARGET

NTTARGETFILE0= \
        $(URTTARGET)\Microsoft.VisualStudio.VCProject.dll
