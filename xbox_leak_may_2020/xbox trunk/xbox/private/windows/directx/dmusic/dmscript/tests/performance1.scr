<script language=vbscript directmusicversion=8.0.0.0>

sub TPlayTwoMeasures
	set seg = LoadSegment("Sample.sgt")
	seg.Download
	PlaySegment(seg)
	mt = GetMusicTime()
	while GetMusicTime() < mt + 768 * 8
	wend
	PerformanceStop seg
end sub

sub TPlayFiveSeconds
	set seg = LoadSegment("Sample.sgt")
	seg.Download
	PlaySegment(seg)
	mt = GetClockTime()
	while GetClockTime() < mt + 5000
	wend
	PerformanceStop seg
end sub

dim TIsPlayingState
sub TIsPlaying
	Playing = True
	if TypeName(TIsPlayingState) = "Empty" then
		Playing = False
	else
		Playing = IsPlaying(, TIsPlayingState)
	end if

	if Playing then
		PerformanceStop
	else
		set seg = LoadSegment("Sample.sgt")
		seg.Download
		set TIsPlayingState = PlaySegment(seg)
	end if
end sub

sub TGetSegmentState
	set segst = GetSegmentState()
	if segst is Nothing then
		set seg = LoadSegment("Sample.sgt")
		seg.Download
		PlaySegment(seg)
	else
		PerformanceStop
	end if
end sub

sub TInvalidate
	Invalidate
end sub

sub TMusicClock
	set seg = LoadSegment("Sample.sgt")
	seg.Download
	PlaySegment(seg)
	m = GetMusicTime()
	c = MusicToClockTime(m)
	c = c + 3000
	m = ClockToMusicTime(c)
	PerformanceStop , , , m
end sub

sub TMasterTempo
	SetMasterTempo(100)
	t = GetMasterTempo()
	SetMasterTempo(t*2)
end sub

sub TMasterVolume
	SetMasterVolume 100
	v = GetMasterVolume()
	SetMasterVolume(v*10)
end sub

sub TMasterGroove
	SetMasterGrooveLevel 0
	gl = GetMasterGrooveLevel
	SetMasterGrooveLevel -50
end sub

sub TReset
	Reset
end sub

sub TStyle
	set sty = GetStyle()
	if sty is Nothing then PlaySegment Nothing end if
end sub
