!include ..\..\..\sources.nv

TARGETNAME=nvpe

!IFDEF NV3
NVCHIP=NV3
!ELSE
NVCHIP=NV4
!ENDIF

!IFNDEF TARGETPATH
TARGETPATH=$(NV_BASE)\drivers\display\winnt4\dump
!ENDIF

TARGETTYPE=LIBRARY

!IFDEF SRCDBG
NTDEBUG=ntsdnodbg
NTDEBUGTYPE=both
!ENDIF

!IFNDEF MSC_WARNING_LEVEL
MSC_WARNING_LEVEL=/W3
!ENDIF

!if ("$(TARGET_OS)" == "win9x")
C_DEFINES = $(C_DEFINES) -Zp -DWIN95 -DNVPE=1
!else
C_DEFINES = $(C_DEFINES) -Zp8 -DWIN32_LEAN_AND_MEAN -DWINNT=1 -DRM_HEAPMGR=1 -DNVD3D -DNVD3D_DX6=1 -D_WIN32_WINNT=0x0500 -DDIRECT3D_VERSION=0x0700 -DNT_UP=1  -DNT_INST=0 -DWIN32=100 -D_NT1X_=100 -DWINVER=0x0500 -D_WIN32_IE=0x0501 -D_WIN32=1 -DNVPE=1
!endif

!IFDEF QUIET
C_DEFINES= $(C_DEFINES) -DQUIET
!ENDIF

C_DEFINES= $(C_DEFINES) -DNVDEPRECATED -D$(NVCHIP)=1 -DRM_HEAPMGR=1 -DNVARCH=$(NVARCH) -DDIRECT3D_VERSION=0x0800

!IFDEF NVD3D
C_DEFINES= $(C_DEFINES) -DNVD3D -D_WIN32=1 -DNVDD32=1
!ENDIF

INCLUDES=..\inc;
INCLUDES=$(INCLUDES);$(NV_BASE)\sdk\nvidia\dx8
INCLUDES=$(INCLUDES);$(BASEDIR)\public\oak\inc
INCLUDES=$(INCLUDES);$(BASEDIR)\public\ddk\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\sdk\nvidia\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\ddraw\common\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\ddraw\celsius\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\ddraw\kelvin\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\common\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\common\vpe
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\common\win9x\inc
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\display\winnt4\miniport\nv_mini
INCLUDES=$(INCLUDES);$(NV_BASE)\drivers\display\winnt4\displays\nv_disp

USE_LIBCNTPR = 1

#D3DOPT = -DNVD3D -DD3D_PUSH=1 -DNVD3D_DX6=1 -DxxxDEBUG=1 -DxxxCACHE_FREECOUNTxxx -DxxxNV_FASTLOOPS -DxxxNV_TEX2

TARGETLIBS= $(BASEDIR)\lib\*\$(DDKBUILDENV)\libcntpr.lib

SOURCES=nvpe.cpp nvpkrnl.cpp

