TARGETNAME=xbshlext
TARGETPATH=obj
TARGETTYPE=DYNLINK
UMTYPE=windows
DLLENTRY = _DllMainCRTStartup

WIN32_WINNT_VERSION=0x0500
WIN32_IE_VERSION=0x0501
SUBSYSTEM_VERSION=5.00

PASS0_HEADERDIR=$(O)
PASS0_UUIDDIR=$(O)
MIDL_TLBDIR=$(O)

SOURCES=               \
    xbshlext.idl       \
    xbshlext.rc        \
    atlimp.cpp         \
    attrib.cpp         \
    console.cpp        \
    cxboxstream.cpp    \
    dataobj.cpp        \
    debug.cpp          \
    delete.cpp         \
    details.cpp        \
    dialogs.cpp        \
    drawpie.cpp        \
    drop.cpp           \
    icon.cpp           \
    menu.cpp           \
    objectwithsite.cpp \
    pidl.cpp           \
    prop.cpp           \
    shellfolder.cpp    \
    utils.cpp          \
    view.cpp           \
    visit.cpp          \
    wizard.cpp         \
    xbfolder.cpp       \
    xbshlext2.cpp      \
    $(O)\xbshlext.c

WSDKP_LIB_PATH=.\sdkp\lib
INCLUDES=.;$(O);.\sdkp\inc;$(WSDK_INC_PATH);$(WSDK_INC_PATH);$(WSDK_INC_PATH)\ATL30
USE_LIBCMT=1
# make sure shlwapi.lib is before shell32.lib for override.
#urlmon is for CopyStgMedium - why the @#$@# is that not in ole32.dll?
TARGETLIBS = \
    $(BASEDIR)\private\lib\*\rsa32.lib \
    $(WSDK_LIB_PATH)\gdi32.lib     \
    $(WSDK_LIB_PATH)\user32.lib    \
    $(WSDK_LIB_PATH)\kernel32.lib  \
    $(WSDK_LIB_PATH)\ws2_32.lib    \
    $(WSDK_LIB_PATH)\mswsock.lib   \
    $(WSDK_LIB_PATH)\ole32.lib     \
    $(WSDK_LIB_PATH)\oleaut32.lib  \
    $(WSDK_LIB_PATH)\uuid.lib      \
    $(WSDK_LIB_PATH)\shlwapi.lib   \
    $(WSDK_LIB_PATH)\shell32.lib   \
    $(WSDK_LIB_PATH)\comctl32.lib  \
    $(WSDK_LIB_PATH)\advapi32.lib  \
    $(WSDK_LIB_PATH)\Urlmon.lib    \
    $(WSDK_LIB_PATH)\htmlhelp.lib  \
    $(WSDKP_LIB_PATH)\shell32p.lib \
    $(SDK_LIB_PATH)\xbdbgs$(D).lib

NTTARGETFILE0=$(O)\xbshlext.c
     

DLLDEF=xbshlext.def
USE_VC7_WINDOWS=1
NOT_LEAN_AND_MEAN=1     
C_DEFINES   = $(C_DEFINES) -DWIN32 -D_WIN32 -DPOSTSPLIT -DUSE_MIRRORING
C_DEFINES   = $(C_DEFINES) -DUNICODE_SHDOCVW
C_DEFINES   = $(C_DEFINES) -DNT -D_MT
C_DEFINES   = $(C_DEFINES) -DUNICODE -D_UNICODE
C_DEFINES   = $(C_DEFINES) -DNO_PRIVATE_HEADERS
C_DEFINES   = $(C_DEFINES) -DFEATURE_IE40 -DNASH
C_DEFINES   = $(C_DEFINES) -D_ATL_STATIC_REGISTRY
C_DEFINES   = $(C_DEFINES) -DXBDBGS

PRECOMPILED_INCLUDE = stdafx.h
PRECOMPILED_CXX=1

#debug definitions
!if "$(FREEBUILD)" == "0"
C_DEFINES       = $(C_DEFINES) -DDEBUG
# Check for missing PURE directives in interface decls (debug only)
C_DEFINES       = $(C_DEFINES) -DNO_NOVTABLE
MSC_OPTIMIZATION=/Odi
!endif
